# üîê Z3r0Trust ‚Äì Trust Me, Always Verified

Z3r0Trust is an autonomous multi-agent security framework powered by Descope to safeguard enterprise systems against modern cyber threats. It continuously authenticates, detects, analyzes, responds, and manages suspicious activities ‚Äî while ensuring transparency, fairness and SOC oversight.

Unlike traditional SIEMs that only record events, Z3r0Trust combines Descope-based authentication & delegation, real-time log intelligence, autonomous response and human appeal workflows to create a resilient defense ecosystem.

Descope acts as a middleware security layer for third-party applications, protecting them from brute force, credential stuffing, suspicious API usage, and more. Any third-party application integrating with Z3r0Trust creates a proxy URL that routes backend traffic through Z3r0Trust middleware. This ensures logs are captured, anomalies are detected, and malicious actors are blocked automatically.

---

## üìõ Project Info

**Project Name:** Z3r0Trust ‚Äì Trust Me, Always Verified  
**Short Description:** An AI-driven, multi-agent framework leveraging **Descope OAuth** for secure inter-agent communication, autonomous detection/response, and fair user management.

## üë• Team ‚Äì Sentinel 5

We are **Sentinel 5**, a passionate team of developers and security innovators dedicated to building resilient, human-centric cyber defense systems. Our expertise spans **full-stack development, cybersecurity, machine learning, DevOps, cloud computing, and UI/UX design**, enabling us to deliver scalable end-to-end solutions.

**Team Members:**

* [Rohit Vijayan B](https://www.linkedin.com/in/rohitvijayan1111/)
* [Divakar G](https://www.linkedin.com/in/divakar3501/)
* [Rithik Raja S](https://www.linkedin.com/in/rithik-raja-s/)
* [Gokul J](https://www.linkedin.com/in/gokul-jeyachandran-37a649229/)
* [Kaviyarasu S](https://www.linkedin.com/in/kaviyarasu-sivaraj-312893262/)

---

## üéØ Hackathon Theme / Challenge Addressed

**Theme 3:** Secure agent-to-agent communication with Descope
**Theme:** Design How Agents Talk, Trust, and Team Up
**Level:** Advanced

**Challenges:**

* Build a secure, multi-agent system where autonomous agents communicate across trust boundaries.
* Include at least two agents with distinct scopes/roles.
* Use **Descope** as the identity and access management layer for all agent communication.
* Enforce **OAuth-based scoped access and delegated trust**.
* Capture and replay **user consent** if agents operate on behalf of users.
* Secure exposed APIs via **Descope Inbound Apps**.

---

## üìå Problem

Enterprises face persistent challenges:

* *Credential theft and phishing* are leading attack vectors.
* *SOC teams are overwhelmed* by noisy or repetitive alerts.
* *Slow response times* due to manual triage.
* *Legitimate users often get blocked* unfairly without recourse.

**Logs alone are not enough.**
Z3r0Trust transforms raw events into *actionable security outcomes* with *autonomous containment and fair user handling*.

---

## üèó Solution

Z3r0Trust introduces a *coordinated system of specialized agents*, each with a clear responsibility. All inter-agent communication is secured via **Descope OAuth tokens** with scoped access, ensuring strict trust boundaries.

**Third-party integration flow:**

* The 3rd-party app integrates with Z3r0Trust by creating a **proxy URL** inside Z3r0Trust.
* All traffic flows through this middleware, where **Descope** authenticates and validates user attributes.
* Logs are captured, anomalies detected, and malicious users are automatically blocked while legitimate access continues.

### Guidelines Alignment

* ‚úÖ Z3r0Trust's agents with clearly defined roles interact using the access tokens generated by **Descope**, ensuring secure and trusted communication.
* ‚úÖ Descope used for all token generation, validation, and delegation.
* ‚úÖ Scope restrictions enforced on all protected endpoints.
* ‚úÖ Delegation demonstrated when one agent acts on behalf of another (e.g., Mail Agent handling alerts).
* ‚úÖ Descope Flows applied for user-facing consent (e.g., MFA, appeal approvals).

---

### With & Without Z3r0Trust

![WhatsApp Image 2025-09-08 at 18 28 56\_9c27b80c](https://github.com/user-attachments/assets/e0a441fb-fe6c-450c-b1e4-c240b50652fb)

### Key Features

* üîë Authentication & validation via **Descope OAuth**
* üì° **Splunk real-time analytics** with anomaly detection
* ü§ñ **AI-powered log summarization** for SOC teams (less noise, faster context)
* ‚ö° Automated response: block, suspend, or monitor
* üì¨ Tiered email notifications: concise for users, forensic for SOC
* üßë‚Äçüíº Human oversight through a **SOC dashboard**
* üìù Transparent appeal system for reinstatements
* üìú Immutable audit trails for compliance

---

## üèó Architecture

```mermaid
flowchart LR
  A[User Login/Action] -->|Logs + Descope Auth| B[Detector Agent]
  B -->|Attributes via Descope + Tokens| C[Analyser Agent]
  C -->|Splunk HEC| D[Alert Handler Agent]
  D -->|Notify| E[Mail MCP Agent]
  D -->|DB Update| F[Database Controller Agent]
  D -->|Appeals| G[Appeal Handler Agent]
  E --> H[User]
  E --> I[SOC Analyst]
  I -->|Review/Override| G
  G -->|Reinstatement| F
```

---

## üèó Systematic Work Flow

![WhatsApp Image 2025-09-08 at 18 22 49\_694ac8cd](https://github.com/user-attachments/assets/000c5550-b0ca-4785-96d2-bf742d9ada4c)

## ü§ñ Agents

### üîç Detector Agent

* Authenticates with **Descope**.
* Retrieves user attributes (IP, device, geo, MFA status).
* Validates logins and flags anomalies.
* Forwards enriched logs to **Splunk**.

### üìä Analyser Agent

* Receives logs from Detector Agent.
* Sends data to **Splunk** for real-time processing.
* Splunk processes in 3 tiers:
  * **High Frequency (5 mins):** Brute force, credential stuffing, suspicious API usage, bot/malware.
  * **Medium Frequency (30 mins):** Impossible travel, account takeover, privilege escalation.
  * **Low Frequency (5 hrs):** Data exfiltration, insider abuse, network anomalies.
* Maintains **MD5 hash cache** (alert\_name.username.ip.device) to prevent duplicate alerts.
* Forwards validated anomalies to Alert Handler Agent.

### üö® Alert Handler Agent

* Processes alert data.
* Decides on appropriate action:
  * Temporary/Permanent block
  * User logout or session invalidation
  * Enforce MFA
* Coordinates with Mail Sender, Database Controller, and Appeal Handler.
* Creates **appeal tickets** in DB.

### üìß Mail Sender Agent

* Handles outbound email notifications.
* Pre-configured with secure sender ID and app passkey.
* Use cases:
  * Alert user of suspicious activity.
  * Notify SOC with forensic details.
  * Confirm appeal submission.
  * Notify user of account reinstatement.

### üóÑ Database Controller Agent

* Securely interfaces with the database under scoped privileges.
* Only executes *traceable and recoverable* operations.
* Acts as a delegate to SOC for safe query execution.

### üìù Appeal Handler Agent

* Activated when a user submits an appeal.
* Reviews alert data + user message.
* If low risk, reinstates account autonomously.
* If uncertain, escalates to **SOC Analyst**.
* Updates DB and notifies user via Mail Sender.

‚û°Ô∏è The last four agents (Alert Handler, Mail Sender, Database Controller, and Appeal Handler) communicate among themselves using secure access keys. If any third-party tries to access them without proper authorization, they are blocked instantly based on **Descope access key authentication**.

---

## üìÇ Example Work Flow (Scenario Based)

**Scenario:** Multiple failed logins ‚Üí sudden success from a new device in Moscow.

1. **Detector** authenticates login via **Descope OAuth**, retrieves attributes, and sends enriched logs to Splunk.
2. **Analyser** correlates with Splunk, scores risk as High.
3. **Alert Handler** suspends account, updates Alerts DB.
4. **Mail MCP Agent** sends:

   * ‚úâ User-friendly alert to employee
   * üìë SOC email with forensic details
5. **SOC Analyst** validates the suspension.
6. **Appeal Agent** reviews employee‚Äôs appeal, reinstates if legitimate.

‚û° Threat contained instantly  
‚û° SOC informed with summarized context  
‚û° User treated fairly with transparent process  
‚û° Full **Descope-based trust validation** ensured

---

## ‚öôÔ∏è What We Built + How to Run It

Z3r0Trust is a **multi-agent security system** powered by **Descope** and **Splunk**.

### Core Workflow

* **Detector Agent**: Validates sessions via Descope, enriches data, forwards to Splunk.
* **Analyser Agent**: Performs correlation, risk scoring.
* **Alert Handler Agent**: Takes enforcement actions (block/logout/MFA).
* **Mail Agent**: Notifies users + SOC.
* **Appeal Agent**: Provides human fairness and consent-based reinstatements.
  
---
## üöÄ Z3r0Trust - Setup & Run Guide

This guide explains how to set up and run the Z3r0Trust project step by step.

üì¶ Prerequisites

    -> Python 3.10+
    
    -> Node.js (>=18.x) + npm
    
    -> pip (Python package manager)
    
    -> A Gmail App Password (for email sending)

    -> Splunk Enterprise
    
    -> A Descope account (for authentication & management keys)

‚öôÔ∏è Environment Variables


1Ô∏è‚É£ Clone the Repository
```
git clone https://github.com/rohitvijayan1111/Z3r0Trust/
cd Z3r0Trust/Agent
```
Create a .env file inside Z3r0Trust/Agent folder with the following:
```
# API Keys
PHI_API_KEY=your_phi_api_key
GROQ_API_KEY=your_groq_api_key
GMAIL_PASSKEY=your_gmail_app_password
DESCOPE_MANAGEMENT_KEY=your_descope_management_key
DESCOPE_PROJECT_ID=your_descope_project_id

# Agent Access Keys (for secure internal communication)
EMAIL_SENDER_AGENT_ACCESS_KEY=your_email_sender_access_key
ALERT_HANDLER_AGENT_ACCESS_KEY=your_alert_handler_access_key
DB_CONTROLLER_AGENT_ACCESS_KEY=your_db_controller_access_key
APPEAL_HANDLER_AGENT_ACCESS_KEY=your_appeal_handler_access_key

# Models and Services
GROQ_MODEL_1=llama-3.1-70b-versatile   # or any supported model
IP_AND_PORT_1=http://localhost:2222
IP_AND_PORT_2=http://localhost:5000

```
‚ö†Ô∏è Never commit .env to GitHub. It‚Äôs already added to .gitignore.


2Ô∏è‚É£ Run the Agent Service
```
pip install -r requirements.txt
python app.py
```
3Ô∏è‚É£ Run the Z3r0Trust - Backend
```
cd ../backend
pip install -r requirements.txt
python app.py
```
4Ô∏è‚É£ Run the Z3r0Trust - Frontend
```
cd ../frontend/zero-trust
npm install
npm run dev
```
5Ô∏è‚É£ Run the Third Party Application (Bank Management App)
```
cd ../Bank
npm install
npm run dev
```
    Login Credentials (Bank Management App)
      Login Id: diva22022.it@rmkec.ac.in
      Password: 123qwe!@#QWE

6Ô∏è‚É£ Bank - Backend ( Z3r0Trust works as Middleware using descope)
```
cd ../Bank/backend
venv\Scripts\activate
pip install -r requirements.txt
uvicorn main:app --reload --port 4000
```
7Ô∏è‚É£ Splunk - Analyzer Agent Working
```
start the splunk enterprise application from start menu
splunk server will start in server URL = 127.0.0.1:8001
Create an index called ZeroTrust logs to save the logs from the detector agent
Configure alerts going into search and reporting, paste the SPL query in it and save it , name the alert, configure CRON job according to the frequency of the threat and set trigger to webhook and paste the url of the Agent's backend service.
SPL queries of various threats - 
```

The frontend will be available at:
```
üëâ http://localhost:5173
```

‚úÖ Notes

Agents communicate securely using the access keys defined in .env.

Ensure all services (Agent, Backend, Frontend) are running simultaneously.

Use Gmail App Password (not your Gmail login password).

Update .env values with actual keys from Descope and Groq.

---

## üõ† Tech Stack

* **Auth & Trust** ‚Äì Descope Console (OAuth, Flows, Scoped Tokens)
* **Backend Agents** ‚Äì Python backend(FastAPI, Flask), MCP and FastMCP, Phidata Agents and Tools
* **Log Analytics** ‚Äì Splunk (SPL, HEC)
* **Frontend Dashboard** ‚Äì React
* **Database** ‚Äì MySQL
* **Email Service** ‚Äì GROQ-based templating
* **Cloud Services** ‚Äì Google Console
---

## üé• Demo Video

üì∫ \[Insert Demo Video Link Here]

---
## üì∏ Snapshots

Descope Inbound Apps:
<img width="1919" height="876" alt="image" src="https://github.com/user-attachments/assets/48239b86-8538-4799-992e-bd42cc6df3bf" />

Deploment Details:
![WhatsApp Image 2025-09-09 at 11 17 39_4a8ea2c7](https://github.com/user-attachments/assets/58c505e2-25bd-4fbb-97db-82cdcb7f1278)
![WhatsApp Image 2025-09-09 at 11 17 39_d71a7e42](https://github.com/user-attachments/assets/9aa6d181-510f-46be-a654-a1b6aac9c6bf)
![WhatsApp Image 2025-09-09 at 11 20 49_ed400f4b](https://github.com/user-attachments/assets/7dba4a46-a472-47c4-80c4-1960c898adf2)


## üé• PPT Link

üì∫ [PPT Link](https://drive.google.com/file/d/1fYZRbzq2pA29tYjK-mGMvCXn1-LyPcj_/view?usp=sharing)


## üîÆ Future Advancements (What We‚Äôd Do With More Time)

* üöÄ Extend adaptive **machine learning models** for advanced anomaly detection.
* üîó Correlate **multi-vector incidents** (e.g., brute force + privilege escalation).
* üöÄ upgrade the MVP to Production ready app 

---

## üìä Impact

Z3r0Trust is built to be both **technically robust** and **human-centric**:

* Reduces breach risk while lowering SOC fatigue
* Balances automation with fairness via multi-agent autonomy
* Ensures **security-by-design** with scoped Descope tokens and access boundaries
* Demonstrates strong technical execution with **Splunk, Descope, FastAPI, React**
* Maintains **connectivity and reliability** through secure APIs and real-time updates

‚ö° Currently, Z3r0Trust represents a **Minimal Viable Product (MVP)** ‚Äì a foundational yet functional system that proves the effectiveness of Descope-secured multi-agent workflows while leaving space for future scaling.

---

## üìß Contact

**Team Sentinel 5**




